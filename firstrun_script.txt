    firstrun_script.txt
    

//if link to this exe is in startup folder, delete it first    
-delstartuplnk

//give new user option to skip running
-message

    this script will cleanup the start menu, remove unneeded 
    apps, change various settings, set wallpaper, etc.

    if you would rather use all the default settings,
    then just press <ENTER>
    
    to continue this script, type Y <ENTER>
    (the script will not take long to run, and you will be 
     prompted to log out after it is run so new settings can 
     take effect- just log back in after you log out)

-message
-continue?

//wallpaper (random from public pictures folder)
-wallpaper c:\users\public\pictures

//import user registry settings
-writefile ~tmp~\hkcu.reg
Windows Registry Editor Version 5.00

;disable suggested apps
;==============================================================================
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager]
"SystemPaneSuggestionsEnabled"=dword:00000000
"SubscribedContent-338388Enabled"=dword:00000000
;  show tips and tricks
"SubscribedContent-338389Enabled"=dword:00000000

;control panel large icons, classic view
;==============================================================================
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel]
"AllItemsIconView"=dword:00000000
"StartupPage"=dword:00000001

;hide desktop icons (0 = show, 1 = hide)
;==============================================================================
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\\HideDesktopIcons\NewStartPanel]
;user folder
"{59031a47-3f72-44a7-89c5-5595fe6b30ee}"=dword:00000000
;my computer
"{20D04FE0-3AEA-1069-A2D8-08002B30309D}"=dword:00000000
; control panel
"{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}"=dword:00000001
; network
"{018D5C66-4533-4307-9B53-224DE2ED1FE6}"=dword:00000001

;ie connection settings (disable auto check connection script)
;==============================================================================
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections]
"DefaultConnectionSettings"=hex:46,00,00,00,03,00,00,00,01,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"SavedLegacySettings"=hex:46,00,00,00,04,00,00,00,01,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00

;ie homepage
;==============================================================================
[HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main]
"Start Page"="http://google.com/"

;ie menu,command bar,status
;==============================================================================
[HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\MINIE]
"AlwaysShowMenus"=dword:00000001
"CommandBarEnabled"=dword:00000001
"ShowStatusBar"=dword:00000001

;do not hide file extensions
;==============================================================================
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
"HideFileExt"=dword:00000000
; taskbar no combine
"TaskbarGlomLevel"=dword:00000001

; turn off people icon on taskbar
;==============================================================================
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People]
"PeopleBand"=dword:00000000

;notifications
;==============================================================================
; Edge
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Microsoft.MicrosoftEdge_8wekyb3d8bbwe!MicrosoftEdge]
"Enabled"=dword:00000000
; Cortana
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Microsoft.Windows.Cortana_cw5n1h2txyewy!CortanaUI]
"Enabled"=dword:00000000
; Store
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Microsoft.WindowsStore_8wekyb3d8bbwe!App]
"Enabled"=dword:00000000
; Suggested
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.SystemToast.Suggested]
"Enabled"=dword:00000000
; Windows Hello
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.SystemToast.HelloFace]
"Enabled"=dword:00000000

;Edge home button and url, new tab use blank page
;cannot do homepage (is encrypted per machine)- have to do manually
;==============================================================================
[HKEY_CURRENT_USER\Software\Classes\Local Settings\Software\Microsoft\Windows\CurrentVersion\AppContainer\Storage\microsoft.microsoftedge_8wekyb3d8bbwe\MicrosoftEdge\Main]
"HomeButtonPage"="https://www.google.com/"
"HomeButtonEnabled"=dword:00000001
[HKEY_CURRENT_USER\Software\Classes\Local Settings\Software\Microsoft\Windows\CurrentVersion\AppContainer\Storage\microsoft.microsoftedge_8wekyb3d8bbwe\MicrosoftEdge\ServiceUI]
"NewTabPageDisplayOption"=dword:00000002
[HKEY_CURRENT_USER\Software\Classes\Local Settings\Software\Microsoft\Windows\CurrentVersion\AppContainer\Storage\microsoft.microsoftedge_8wekyb3d8bbwe\MicrosoftEdge\TabbedBrowsing]
"NTPFirstRun"=dword:00000001

;cortana hidden
;==============================================================================
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Search]
"SearchboxTaskbarMode"=dword:00000000

;Foxit Reader settings
;==============================================================================
[HKEY_CURRENT_USER\Software\Foxit Software\Foxit Reader 9.0\Preferences\General]
"bShowStartPage"="0"
"bShowAdvertisement"="0"
"bShowFloatingPromotionPage"="0"
"bCollectData"="0"
[HKEY_CURRENT_USER\Software\Foxit Software\Foxit Reader 9.0\Preferences\Registration]
"bShowRegisterDlg"="0"
[HKEY_CURRENT_USER\Software\Foxit Software\Foxit Reader 9.0\Preferences\Others]
"bCheckRegister"="0"
-writefile
-regimport ~tmp~\hkcu.reg

//clear all pinned apps
-unpinstart -all
-unpintaskbar -all

//pin to start using file (-listapps format)
-writefile <tmp>\pinapps.txt
[S  ] Calculator
[S  ] Control Panel
[S  ] File Explorer
[S  ] Google Chrome
[S  ] Microsoft Edge
[S  ] Settings
[S  ] Task Manager
[S  ] Weather
[S  ] Windows Defender Security Center
-writefile
-pinstart ~tmp~\pinapps.txt

//remove apps
//using self created -listapps format file where we use the name for
//all packages (which is the start of the full name and family name),
//but we have to include the first underscore character
//this list is from a clean install of Win10 ver 1803
//mark for uninstall with [  X]
-writefile <tmp>\removeapps.txt
[   ] Microsoft.BingWeather_
[   ] Microsoft.DesktopAppInstaller_
[   ] Microsoft.GetHelp_
[   ] Microsoft.Getstarted_
[  X] Microsoft.Messaging_
[  X] Microsoft.Microsoft3DViewer_
[  X] Microsoft.MicrosoftOfficeHub_
[   ] Microsoft.MicrosoftSolitaireCollection_
[   ] Microsoft.MicrosoftStickyNotes_
[  X] Microsoft.MSPaint_
[  X] Microsoft.Office.OneNote_
[  X] Microsoft.OneConnect_
[  X] Microsoft.People_
[  X] Microsoft.Print3D_
[  X] Microsoft.SkypeApp_
[  X] Microsoft.StorePurchaseApp_
[  X] Microsoft.Wallet_
[   ] Microsoft.WebMediaExtensions_
[   ] Microsoft.Windows.Photos_
[   ] Microsoft.WindowsAlarms_
[   ] Microsoft.WindowsCalculator_
[   ] Microsoft.WindowsCamera_
[  X] microsoft.windowscommunicationsapps_
[  X] Microsoft.WindowsFeedbackHub_
[   ] Microsoft.WindowsMaps_
[  X] Microsoft.WindowsSoundRecorder_
[   ] Microsoft.WindowsStore_
[  X] Microsoft.Xbox.TCUI_
[  X] Microsoft.XboxApp_
[  X] Microsoft.XboxGameOverlay_
[  X] Microsoft.XboxGamingOverlay_
[  X] Microsoft.XboxIdentityProvider_
[  X] Microsoft.XboxSpeechToTextOverlay_
[  X] Microsoft.ZuneMusic_
[  X] Microsoft.ZuneVideo_
-writefile
-removeappx ~tmp~\removeapps.txt

//weather location to 51247
-weather

-message

    press ENTER to log out now so some settings can take effect
    just log back in after being logged out
    
-message
-continue?

